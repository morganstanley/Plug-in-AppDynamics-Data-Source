/* [create-plugin] version: 6.6.0 */
/* [create-plugin] plugin: appdynamics-datasource@1.0.1 */
define(["module","@grafana/ui","react","@grafana/data","@grafana/runtime"],(t,e,r,n,o)=>(()=>{var a={41(t){t.exports=function(t){return function(e){return t(e)}}},492(t,e,r){t=r.nmd(t);var n=r(1433),o=r(659),a=e&&!e.nodeType&&e,i=a&&t&&!t.nodeType&&t,u=i&&i.exports===a?n.Buffer:void 0,c=(u?u.isBuffer:void 0)||o;t.exports=c},659(t){t.exports=function(){return!1}},1163(t,e,r){var n=r(6204),o=r(1256),a=r(6397),i=r(492),u=r(2845),c=r(7995),s=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=a(t),l=!r&&o(t),p=!r&&!l&&i(t),f=!r&&!l&&!p&&c(t),d=r||l||p||f,v=d?n(t.length,String):[],y=v.length;for(var b in t)!e&&!s.call(t,b)||d&&("length"==b||p&&("offset"==b||"parent"==b)||f&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||u(b,y))||v.push(b);return v}},1256(t,e,r){var n=r(9250),o=r(2934),a=Object.prototype,i=a.hasOwnProperty,u=a.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(t){return o(t)&&i.call(t,"callee")&&!u.call(t,"callee")};t.exports=c},1308(e){"use strict";e.exports=t},1433(t,e,r){var n=r(5380),o="object"==typeof self&&self&&self.Object===Object&&self,a=n||o||Function("return this")();t.exports=a},1485(t){var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},1491(t,e,r){var n=r(8953),o=r(7499),a=r(8201),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return a(t);var e=o(t),r=[];for(var u in t)("constructor"!=u||!e&&i.call(t,u))&&r.push(u);return r}},1506(t,e,r){var n=r(4796),o=r(5265),a=r(6805);t.exports=function(t,e){return a(o(t,e,n),t+"")}},1738(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},2007(t){"use strict";t.exports=e},2781(t,e,r){var n=r(1433).Symbol;t.exports=n},2845(t){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var n=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&e.test(t))&&t>-1&&t%1==0&&t<r}},2934(t){t.exports=function(t){return null!=t&&"object"==typeof t}},3122(t){t.exports=function(t){return function(){return t}}},3330(t){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3685(t,e,r){t=r.nmd(t);var n=r(5380),o=e&&!e.nodeType&&e,a=o&&t&&!t.nodeType&&t,i=a&&a.exports===o&&n.process,u=function(){try{var t=a&&a.require&&a.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u},3936(t,e,r){var n=r(1506),o=r(9316),a=r(6220),i=r(5405),u=Object.prototype,c=u.hasOwnProperty,s=n(function(t,e){t=Object(t);var r=-1,n=e.length,s=n>2?e[2]:void 0;for(s&&a(e[0],e[1],s)&&(n=1);++r<n;)for(var l=e[r],p=i(l),f=-1,d=p.length;++f<d;){var v=p[f],y=t[v];(void 0===y||o(y,u[v])&&!c.call(t,v))&&(t[v]=l[v])}return t});t.exports=s},3983(t){var e=Date.now;t.exports=function(t){var r=0,n=0;return function(){var o=e(),a=16-(o-n);if(n=o,a>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}},4796(t){t.exports=function(t){return t}},5265(t,e,r){var n=r(6701),o=Math.max;t.exports=function(t,e,r){return e=o(void 0===e?t.length-1:e,0),function(){for(var a=arguments,i=-1,u=o(a.length-e,0),c=Array(u);++i<u;)c[i]=a[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=a[i];return s[e]=r(c),n(t,this,s)}}},5380(t,e,r){var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=n},5405(t,e,r){var n=r(1163),o=r(1491),a=r(8330);t.exports=function(t){return a(t)?n(t,!0):o(t)}},5959(t){"use strict";t.exports=r},6204(t){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},6220(t,e,r){var n=r(9316),o=r(8330),a=r(2845),i=r(8953);t.exports=function(t,e,r){if(!i(r))return!1;var u=typeof e;return!!("number"==u?o(r)&&a(e,r.length):"string"==u&&e in r)&&n(r[e],t)}},6397(t){var e=Array.isArray;t.exports=e},6567(t,e,r){var n=r(8446),o=r(8092),a=r(8953),i=r(1485),u=/^\[object .+?Constructor\]$/,c=Function.prototype,s=Object.prototype,l=c.toString,p=s.hasOwnProperty,f=RegExp("^"+l.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||o(t))&&(n(t)?f:u).test(i(t))}},6701(t){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},6772(t){t.exports=function(t,e){return null==t?void 0:t[e]}},6805(t,e,r){var n=r(7310),o=r(3983)(n);t.exports=o},7129(t,e,r){var n=r(7148),o=r(3330),a=r(2934),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&o(t.length)&&!!i[n(t)]}},7148(t,e,r){var n=r(2781),o=r(7903),a=r(1738),i=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":i&&i in Object(t)?o(t):a(t)}},7310(t,e,r){var n=r(3122),o=r(8559),a=r(4796),i=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:a;t.exports=i},7499(t){var e=Object.prototype;t.exports=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},7781(t){"use strict";t.exports=n},7903(t,e,r){var n=r(2781),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,u=n?n.toStringTag:void 0;t.exports=function(t){var e=a.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var o=i.call(t);return n&&(e?t[u]=r:delete t[u]),o}},7995(t,e,r){var n=r(7129),o=r(41),a=r(3685),i=a&&a.isTypedArray,u=i?o(i):n;t.exports=u},8092(t,e,r){var n,o=r(8109),a=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!a&&a in t}},8109(t,e,r){var n=r(1433)["__core-js_shared__"];t.exports=n},8201(t){t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},8330(t,e,r){var n=r(8446),o=r(3330);t.exports=function(t){return null!=t&&o(t.length)&&!n(t)}},8446(t,e,r){var n=r(7148),o=r(8953);t.exports=function(t){if(!o(t))return!1;var e=n(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},8531(t){"use strict";t.exports=o},8559(t,e,r){var n=r(9138),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},8953(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},9138(t,e,r){var n=r(6567),o=r(6772);t.exports=function(t,e){var r=o(t,e);return n(r)?r:void 0}},9250(t,e,r){var n=r(7148),o=r(2934);t.exports=function(t){return o(t)&&"[object Arguments]"==n(t)}},9316(t){t.exports=function(t,e){return t===e||t!=t&&e!=e}}},i={};function u(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return a[t](r,r.exports,u),r.loaded=!0,r.exports}u.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return u.d(e,{a:e}),e},u.d=(t,e)=>{for(var r in e)u.o(e,r)&&!u.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),u.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),u.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),u.p="public/plugins/appdynamics-datasource/";var c={};return(()=>{"use strict";u.r(c),u.d(c,{plugin:()=>O});var t=u(1308),e=u.n(t);u.p=e()&&e().uri?e().uri.slice(0,e().uri.lastIndexOf("/")+1):"public/plugins/appdynamics-datasource/";var r=u(7781),n=u(8531);function o(t,e,r,n,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function u(t){o(i,n,a,u,c,"next",t)}function c(t){o(i,n,a,u,c,"throw",t)}u(void 0)})}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class s extends r.DataSourceApi{doRequest(t,e,r,n,o){return a(function*(){return this.backendSrv.datasourceRequest({url:`${this.url}/controller/rest/applications/${e}/metric-data`,method:"GET",params:{"metric-path":r,"time-range-type":"BETWEEN_TIMES","start-time":n,"end-time":o,rollup:"false",output:"json"},headers:{"Content-Type":"application/json"}})}).call(this)}getApplicationNames(t){return a(function*(){const t=yield this.backendSrv.datasourceRequest({url:`${this.url}/controller/rest/applications`,method:"GET",params:{output:"json"}});return 200!==t.status?[]:this.getFilteredNames("",t.data)}).call(this)}getFilteredNames(t,e){var r;const n=t.includes("|")?null!==(r=t.split("|").pop())&&void 0!==r?r:"":t;return 0===n.length?e:e.filter(t=>{const e=t.name.toLowerCase(),r=n.toLowerCase();return r.includes(e)||e.includes(r)})}query(t){return a(function*(){const e=this.toEpochMillis(t.range.from),n=this.toEpochMillis(t.range.to);return{data:yield Promise.all(t.targets.map(t=>a(function*(){const o=yield this.doRequest(t.host,t.application,t.queryText,e,n),a=new r.MutableDataFrame({refId:t.refId,fields:[{name:"Time",type:r.FieldType.time},{name:t.queryText,type:r.FieldType.number}]});return this.convertMetricData(o).forEach(t=>{a.appendRow([t[1],t[0]])}),a}).call(this)))}}).call(this)}testDatasource(){return a(function*(){const t=yield this.backendSrv.datasourceRequest({url:`${this.url}/controller/rest/applications`,method:"GET",params:{output:"json"}});return 200===t.status?{status:"success",message:"Data source is working",title:"Success"}:{status:"failure",message:`Data source is not working due to: ${t.status}`,title:"Failure"}}).call(this)}convertMetricData(t){var e,r,n;if(!t||"string"==typeof t)return[];return(null!==(e=null===(n=t.data)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.metricValues)&&void 0!==e?e:[]).map(t=>[t.value,t.startTimeInMillis])}toEpochMillis(t){var e;const n=r.dateMath.parse(t);return Math.ceil(null!==(e=null==n?void 0:n.valueOf())&&void 0!==e?e:0)}constructor(t,e=(0,n.getBackendSrv)()){var r;super(t),i(this,"backendSrv",void 0),i(this,"url",void 0),this.backendSrv=e,this.url=null!==(r=t.url)&&void 0!==r?r:""}}var l=u(5959),p=u.n(l),f=u(2007);class d extends l.PureComponent{render(){const{options:t,onOptionsChange:e}=this.props;return p().createElement("div",{className:"gf-form-group"},p().createElement(f.DataSourceHttpSettings,{defaultUrl:"http://localhost:8080",dataSourceConfig:t,onChange:e}))}}var v=u(3936),y=u.n(v);const b={};function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){g(t,e,r[e])})}return t}function m(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}const{FormField:j}=f.LegacyForms;class x extends l.PureComponent{render(){const t=y()(this.props.query,b),{queryText:e,application:r}=t;return p().createElement("div",{className:"section gf-form-group"},p().createElement("div",{className:"gf-form gf-form--grow"},p().createElement(j,{value:r||"",onChange:this.onApplicationChange,labelWidth:5,inputWidth:80,label:"Application",type:"string"})),p().createElement("div",{className:"gf-form gf-form--grow"},p().createElement(j,{value:e||"",onChange:this.onQueryTextChange,labelWidth:5,inputWidth:80,label:"Query",type:"string"})))}constructor(...t){super(...t),g(this,"onQueryTextChange",t=>{const{onChange:e,query:r}=this.props;e(m(h({},r),{queryText:t.target.value}))}),g(this,"onApplicationChange",t=>{const{onChange:e,query:r}=this.props;e(m(h({},r),{application:t.target.value}))})}}const O=new r.DataSourcePlugin(s).setConfigEditor(d).setQueryEditor(x)})(),c})());
//# sourceMappingURL=module.js.map